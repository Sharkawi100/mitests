<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mitests - لوحة الطالب</title>
  <meta name="description" content="لوحة طالب ملونة مع اختبارات قادمة، تقدم دراسي، وتقارير حديثة.">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="styles.css">

  <style>
    .student-navbar { border-bottom: 1px solid var(--color-gray-200); }
    body.rtl .main-content .student-navbar { right: var(--sidebar-width); left: 0; }
    body.ltr .main-content .student-navbar { left: var(--sidebar-width); right: 0; }
    body.rtl .main-content.main-content--expanded .student-navbar { right: var(--sidebar-collapsed-width); }
    body.ltr .main-content.main-content--expanded .student-navbar { left: var(--sidebar-collapsed-width); }

    .student-navbar .navbar__brand-icon { background: linear-gradient(135deg, var(--color-student), #24c6c6); }
    .sidebar__item:hover, .sidebar__item--active { background: rgba(14, 165, 165, 0.22); color: var(--color-white); }
    .sidebar__item--active { border-inline-start: 3px solid var(--color-student); }

    .btn--student { background: var(--color-student); border-color: var(--color-student); color: var(--color-white); }
    .btn--student:hover { background: #0b8b8b; border-color: #0b8b8b; color: var(--color-white); }
    .btn--start {
      background: linear-gradient(135deg, var(--color-student), #21bdbd);
      border-color: var(--color-student);
      color: var(--color-white);
      box-shadow: 0 10px 18px rgba(14, 165, 165, 0.25);
      transition: transform var(--transition-fast), box-shadow var(--transition-fast);
    }
    .btn--start:hover { transform: translateY(-2px); box-shadow: 0 15px 24px rgba(14, 165, 165, 0.32); color: var(--color-white); }

    .student-main {
      padding: calc(var(--navbar-height) + var(--space-6)) var(--space-6) var(--space-8);
      display: grid;
      gap: var(--space-5);
    }

    .welcome-card {
      background: linear-gradient(145deg, rgba(14, 165, 165, 0.16), rgba(255, 255, 255, 1) 58%);
      border: 1px solid var(--color-teal-100);
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow-md);
      border-top: 4px solid var(--color-student);
      padding: var(--space-6);
      display: grid;
      gap: var(--space-2);
    }

    .welcome-card h1 { color: var(--color-gray-900); font-size: var(--font-size-3xl); line-height: 1.3; }
    .welcome-card p { color: var(--color-gray-600); }

    .section-title-inline { color: var(--color-gray-900); font-size: var(--font-size-2xl); margin-bottom: var(--space-2); }

    .coming-list {
      display: grid;
      gap: var(--space-3);
    }

    .coming-item {
      border: 1px solid var(--color-gray-200);
      border-radius: var(--border-radius-md);
      background: var(--color-white);
      padding: var(--space-4);
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: var(--space-3);
      flex-wrap: wrap;
    }

    .coming-item__meta h3 { color: var(--color-gray-900); font-size: var(--font-size-lg); margin-bottom: var(--space-1); }
    .coming-item__meta p { color: var(--color-gray-500); font-size: var(--font-size-sm); }

    .groups-grid {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: var(--space-3);
    }

    .group-card {
      border: 1px solid var(--color-gray-200);
      border-top: 4px solid var(--color-student);
      border-radius: var(--border-radius-md);
      background: var(--color-white);
      padding: var(--space-4);
      display: grid;
      gap: var(--space-2);
    }

    .group-card h3 { color: var(--color-gray-900); font-size: var(--font-size-lg); }
    .group-card p { color: var(--color-gray-600); font-size: var(--font-size-sm); }

    .group-card--link {
      text-decoration: none; color: inherit; cursor: pointer;
      transition: transform var(--transition-fast), box-shadow var(--transition-fast);
    }
    .group-card--link:hover { transform: translateY(-3px); box-shadow: var(--shadow-md); color: inherit; }
    .group-card__action {
      font-size: var(--font-size-xs); color: var(--color-student); font-weight: 600;
      display: inline-flex; align-items: center; gap: var(--space-1);
      margin-top: var(--space-1); opacity: 0.7; transition: opacity var(--transition-fast);
    }
    .group-card--link:hover .group-card__action { opacity: 1; }

    .chart-card {
      border: 1px solid var(--color-gray-200);
      border-radius: var(--border-radius-md);
      background: var(--color-white);
      padding: var(--space-4);
      display: grid;
      gap: var(--space-3);
    }

    .chart-placeholder {
      min-height: 230px;
      border-radius: var(--border-radius-md);
      border: 1px dashed var(--color-student);
      background:
        linear-gradient(180deg, rgba(14, 165, 165, 0.11), rgba(14, 165, 165, 0.03)),
        repeating-linear-gradient(90deg, rgba(14, 165, 165, 0.10) 0, rgba(14, 165, 165, 0.10) 2px, transparent 2px, transparent 20px);
      display: flex;
      align-items: center;
      justify-content: center;
      color: #0b8b8b;
      font-weight: 700;
      text-align: center;
      padding: var(--space-4);
    }

    .table-wrap { overflow-x: auto; }
    .data-table { width: 100%; border-collapse: collapse; min-width: 620px; }
    .data-table th, .data-table td {
      padding: var(--space-3);
      border-bottom: 1px solid var(--color-gray-200);
      text-align: start;
      font-size: var(--font-size-sm);
    }
    .data-table th { color: var(--color-gray-500); font-weight: 600; background: var(--color-gray-50); }

    .grade-pill {
      background: var(--color-teal-100);
      color: #0b8b8b;
      border-radius: var(--border-radius-full);
      padding: var(--space-1) var(--space-3);
      font-size: var(--font-size-xs);
      font-weight: 700;
      display: inline-flex;
      align-items: center;
    }

    @media (max-width: 1023px) {
      body.rtl .main-content .student-navbar { right: var(--sidebar-collapsed-width); }
      body.ltr .main-content .student-navbar { left: var(--sidebar-collapsed-width); }
      body.rtl .main-content { margin-right: var(--sidebar-collapsed-width); }
      body.ltr .main-content { margin-left: var(--sidebar-collapsed-width); }
      .sidebar { width: var(--sidebar-collapsed-width); }
      .sidebar .sidebar__brand-text, .sidebar .sidebar__item span, .sidebar .sidebar__toggle span { display: none; }
      .groups-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }

    @media (max-width: 767px) {
      .sidebar { display: none; }
      body.rtl .main-content, body.ltr .main-content { margin: 0; }
      body.rtl .main-content .student-navbar, body.ltr .main-content .student-navbar { right: 0; left: 0; }
      .student-main { padding-inline: var(--space-4); }
      .welcome-card h1 { font-size: var(--font-size-2xl); }
      .groups-grid { grid-template-columns: 1fr; }
      .coming-item .btn { width: 100%; }
    }
  </style>
</head>

<body class="rtl">
  <aside class="sidebar" id="sidebar" aria-label="Sidebar navigation">
    <div class="sidebar__header">
      <div class="sidebar__logo">M</div>
      <span class="sidebar__brand-text">سراج - الطالب</span>
    </div>
    <nav class="sidebar__nav">
      <a class="sidebar__item sidebar__item--active" href="student-dashboard.html"><i class="fas fa-gauge"></i><span data-i18n="navOverview">نظرة عامة</span></a>
      <a class="sidebar__item" href="student-coming-tests.html"><i class="fas fa-calendar-days"></i><span data-i18n="navComing">اختبارات قادمة</span></a>
      <a class="sidebar__item" href="student-groups.html"><i class="fas fa-users"></i><span data-i18n="navGroups">مجموعاتي</span></a>
      <a class="sidebar__item" href="student-learning.html"><i class="fas fa-chart-line"></i><span data-i18n="navLearning">مسار التعلم</span></a>
      <a class="sidebar__item" href="student-reports.html"><i class="fas fa-file-circle-check"></i><span data-i18n="navReports">تقارير حديثة</span></a>
      <a class="sidebar__item" href="student-settings.html"><i class="fas fa-gear"></i><span data-i18n="navSettings">الإعدادات</span></a>
    </nav>
    <button class="sidebar__toggle" id="sidebar-toggle" aria-label="Toggle sidebar"><i class="fas fa-angles-right"></i><span>تصغير</span></button>
  </aside>

  <div class="main-content" id="main-content">
    <nav class="navbar student-navbar" role="navigation" aria-label="Student top navigation">
      <a href="student-dashboard.html" class="navbar__brand">
        <div class="navbar__brand-icon"><i class="fas fa-graduation-cap"></i></div>
        <span class="navbar__brand-text" data-i18n="brand">مساحة الطالب</span>
      </a>
      <div class="navbar__actions">
        <div class="lang-switcher" role="group" aria-label="Language selector">
          <button class="lang-switcher__btn active" data-lang="ar" aria-label="Arabic">&#1593;</button>
          <button class="lang-switcher__btn" data-lang="he" aria-label="Hebrew">&#1506;&#1489;</button>
          <button class="lang-switcher__btn" data-lang="en" aria-label="English">En</button>
        </div>
        <div class="notification-bell" id="student-notif-bell">
          <button class="notification-bell__btn" type="button" aria-label="الإشعارات"><i class="fas fa-bell"></i></button>
          <span class="notification-bell__badge" id="student-notif-badge">2</span>
          <div class="notification-panel" id="student-notif-panel">
            <div class="notification-panel__header"><h3>الإشعارات</h3><button class="notification-panel__mark-read" id="student-mark-read" type="button">تعيين الكل كمقروء</button></div>
            <div class="notification-panel__body" id="student-notif-body"></div>
          </div>
        </div>
        <div class="avatar-dropdown">
          <button class="avatar-btn" type="button" data-avatar-toggle="student-avatar-menu" aria-label="قائمة حساب الطالب">
            <i class="fas fa-user-graduate"></i>
          </button>
          <div class="avatar-menu" id="student-avatar-menu" data-avatar-menu>
            <span class="avatar-menu__label">حساب الطالب</span>
            <a class="avatar-menu__link" href="student-profile.html"><i class="fas fa-id-card"></i><span>الملف الشخصي</span></a>
            <a class="avatar-menu__link" href="student-settings.html"><i class="fas fa-gear"></i><span>الإعدادات</span></a>
          </div>
        </div>
        <a href="index.html" class="btn btn--student btn--sm"><i class="fas fa-right-from-bracket"></i><span data-i18n="logout">تسجيل الخروج</span></a>
      </div>
    </nav>

    <main class="student-main">
      <header class="welcome-card" id="overview">
        <h1 id="welcome-title"></h1>
        <p data-i18n="welcomeSub">تابع تقدمك خطوة بخطوة وراقب تطورك مع الوقت.</p>
      </header>

      <section id="coming-tests" class="card">
        <h2 class="section-title-inline" data-i18n="comingTitle">الاختبارات القادمة</h2>
        <div class="coming-list">
          <article class="coming-item">
            <div class="coming-item__meta">
              <h3 data-i18n="exam1Title">الإنجليزية - الوحدة 5</h3>
              <p data-i18n="exam1Meta">الأحد، 18:00 | 45 دقيقة</p>
            </div>
            <a href="student-exam.html" class="btn btn--start" data-i18n="startExam">ابدأ الاختبار</a>
          </article>
          <article class="coming-item">
            <div class="coming-item__meta">
              <h3 data-i18n="exam2Title">الرياضيات - الدوال</h3>
              <p data-i18n="exam2Meta">الثلاثاء، 16:30 | 60 دقيقة</p>
            </div>
            <a href="student-exam.html" class="btn btn--start" data-i18n="startExam">ابدأ الاختبار</a>
          </article>
          <article class="coming-item">
            <div class="coming-item__meta">
              <h3 data-i18n="exam3Title">العلوم - الجهاز التنفسي</h3>
              <p data-i18n="exam3Meta">الخميس، 17:00 | 35 دقيقة</p>
            </div>
            <a href="student-exam.html" class="btn btn--start" data-i18n="startExam">ابدأ الاختبار</a>
          </article>
        </div>
      </section>

      <section id="my-groups" class="card">
        <h2 class="section-title-inline" data-i18n="groupsTitle">مجموعاتي</h2>
        <div class="groups-grid">
          <a href="student-group-detail.html" class="group-card group-card--link">
            <h3 data-i18n="group1">الصف تاسع 1 - إنجليزي</h3>
            <p data-i18n="group1Meta">المعلم: أشرف شرقاوي</p>
            <span class="group-card__action" data-i18n="viewGroup"><i class="fas fa-arrow-left"></i> عرض التفاصيل</span>
          </a>
          <a href="student-group-detail.html" class="group-card group-card--link">
            <h3 data-i18n="group2">الصف تاسع 1 - رياضيات</h3>
            <p data-i18n="group2Meta">المعلم: محمد عبد الرحمن</p>
            <span class="group-card__action" data-i18n="viewGroup"><i class="fas fa-arrow-left"></i> عرض التفاصيل</span>
          </a>
          <a href="student-group-detail.html" class="group-card group-card--link">
            <h3 data-i18n="group3">الصف تاسع 1 - علوم</h3>
            <p data-i18n="group3Meta">المعلمة: سمية حسن</p>
            <span class="group-card__action" data-i18n="viewGroup"><i class="fas fa-arrow-left"></i> عرض التفاصيل</span>
          </a>
        </div>
      </section>

      <section id="learning-process" class="card chart-card">
        <h2 class="section-title-inline" data-i18n="learningTitle">مسار التعلم</h2>
        <div class="chart-placeholder" data-i18n="learningPlaceholder">عنصر نائب لمخطط خطي: اتجاه العلامات في آخر 5 اختبارات</div>
      </section>

      <section id="recent-reports" class="card">
        <h2 class="section-title-inline" data-i18n="reportsTitle">التقارير الحديثة</h2>
        <div class="table-wrap">
          <table class="data-table">
            <thead>
              <tr>
                <th data-i18n="reportsExam">الاختبار</th>
                <th data-i18n="reportsGrade">العلامة النهائية</th>
                <th data-i18n="reportsAction">إجراء</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td data-i18n="report1Exam">الإنجليزية - الوحدة 4</td>
                <td><span class="grade-pill">88</span></td>
                <td><a href="student-feedback.html" class="btn btn--student btn--sm" data-i18n="viewFeedback">عرض الملاحظات</a></td>
              </tr>
              <tr>
                <td data-i18n="report2Exam">الرياضيات - الكسور</td>
                <td><span class="grade-pill">92</span></td>
                <td><a href="student-feedback.html" class="btn btn--student btn--sm" data-i18n="viewFeedback">عرض الملاحظات</a></td>
              </tr>
              <tr>
                <td data-i18n="report3Exam">العلوم - علم البيئة</td>
                <td><span class="grade-pill">84</span></td>
                <td><a href="student-feedback.html" class="btn btn--student btn--sm" data-i18n="viewFeedback">عرض الملاحظات</a></td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <section id="settings" class="card">
        <h2 class="section-title-inline" data-i18n="settingsTitle">الإعدادات</h2>
        <p data-i18n="settingsText">إدارة تفضيلات اللغة، سهولة الاستخدام وتنبيهات الاختبارات.</p>
      </section>
    </main>
  </div>

  <script src="shared-layout.js"></script>
  <script>
    (function () {
      'use strict';

      var STUDENT_NAME = 'نورا الخطيب';

      var I18N = {
        he: {
          pageTitle: 'Mitests - לוח תלמיד',
          pageDescription: 'לוח תלמיד צבעוני עם מבחנים קרובים, התקדמות אישית ודוחות.',
          brand: 'מרחב תלמיד',
          logout: 'יציאה',
          navOverview: 'סקירה',
          navComing: 'מבחנים קרובים',
          navGroups: 'הקבוצות שלי',
          navLearning: 'תהליך למידה',
          navReports: 'דוחות אחרונים',
          navSettings: 'הגדרות',
          welcomeTemplate: 'ברוך שובך, {name}! מוכן לאתגר הבא?',
          welcomeSub: 'המשיכו בקצב שלכם וצפו בתהליך ההתקדמות לאורך זמן.',
          comingTitle: 'מבחנים קרובים',
          startExam: 'התחל מבחן',
          exam1Title: 'אנגלית - Unit 5',
          exam1Meta: 'יום ראשון, 18:00 | 45 דקות',
          exam2Title: 'מתמטיקה - פונקציות',
          exam2Meta: 'יום שלישי, 16:30 | 60 דקות',
          exam3Title: 'מדעים - מערכת הנשימה',
          exam3Meta: 'יום חמישי, 17:00 | 35 דקות',
          groupsTitle: 'הקבוצות שלי',
          group1: 'כיתה ט\'1 - אנגלית',
          group1Meta: 'מורה: אשרף שרקאווי',
          group2: 'כיתה ט\'1 - מתמטיקה',
          group2Meta: 'מורה: מוחמד עבד אלרחמן',
          group3: 'כיתה ט\'1 - מדעים',
          group3Meta: 'מורה: סומיה חסן',
          viewGroup: '← צפייה בפרטים',
          learningTitle: 'תהליך הלמידה',
          learningPlaceholder: 'מקום לתרשים קו: מגמת ציונים ב-5 המבחנים האחרונים',
          reportsTitle: 'דוחות אחרונים',
          reportsExam: 'מבחן',
          reportsGrade: 'ציון סופי',
          reportsAction: 'פעולה',
          viewFeedback: 'צפה במשוב',
          report1Exam: 'אנגלית - Unit 4',
          report2Exam: 'מתמטיקה - שברים',
          report3Exam: 'מדעים - אקולוגיה',
          settingsTitle: 'הגדרות',
          settingsText: 'ניהול העדפות שפה, נגישות והתראות מבחנים.'
        },
        ar: {
          pageTitle: 'Mitests - لوحة الطالب',
          pageDescription: 'لوحة طالب ملونة مع اختبارات قادمة، تقدم تعليمي وتقارير.',
          brand: 'مساحة الطالب',
          logout: 'تسجيل الخروج',
          navOverview: 'نظرة عامة',
          navComing: 'اختبارات قادمة',
          navGroups: 'مجموعاتي',
          navLearning: 'مسار التعلم',
          navReports: 'تقارير حديثة',
          navSettings: 'الإعدادات',
          welcomeTemplate: 'مرحبًا بعودتك، {name}! هل أنت جاهز للتحدي القادم؟',
          welcomeSub: 'تابع تقدمك خطوة بخطوة وراقب تطورك مع الوقت.',
          comingTitle: 'الاختبارات القادمة',
          startExam: 'ابدأ الاختبار',
          exam1Title: 'الإنجليزية - الوحدة 5',
          exam1Meta: 'الأحد، 18:00 | 45 دقيقة',
          exam2Title: 'الرياضيات - الدوال',
          exam2Meta: 'الثلاثاء، 16:30 | 60 دقيقة',
          exam3Title: 'العلوم - الجهاز التنفسي',
          exam3Meta: 'الخميس، 17:00 | 35 دقيقة',
          groupsTitle: 'مجموعاتي',
          group1: 'الصف تاسع 1 - إنجليزي',
          group1Meta: 'المعلم: أشرف شرقاوي',
          group2: 'الصف تاسع 1 - رياضيات',
          group2Meta: 'المعلم: محمد عبد الرحمن',
          group3: 'الصف تاسع 1 - علوم',
          group3Meta: 'المعلمة: سمية حسن',
          viewGroup: '→ عرض التفاصيل',
          learningTitle: 'مسار التعلم',
          learningPlaceholder: 'عنصر نائب لمخطط خطي: اتجاه العلامات في آخر 5 اختبارات',
          reportsTitle: 'التقارير الحديثة',
          reportsExam: 'الاختبار',
          reportsGrade: 'العلامة النهائية',
          reportsAction: 'إجراء',
          viewFeedback: 'عرض الملاحظات',
          report1Exam: 'الإنجليزية - الوحدة 4',
          report2Exam: 'الرياضيات - الكسور',
          report3Exam: 'العلوم - علم البيئة',
          settingsTitle: 'الإعدادات',
          settingsText: 'إدارة تفضيلات اللغة، سهولة الاستخدام وتنبيهات الاختبارات.'
        },
        en: {
          pageTitle: 'Mitests - Student Dashboard',
          pageDescription: 'Colorful student dashboard with upcoming tests, learning progress, and reports.',
          brand: 'Student Space',
          logout: 'Logout',
          navOverview: 'Overview',
          navComing: 'Coming Tests',
          navGroups: 'My Groups',
          navLearning: 'Learning Process',
          navReports: 'Recent Reports',
          navSettings: 'Settings',
          welcomeTemplate: 'Welcome back, {name}! Ready for your next challenge?',
          welcomeSub: 'Keep your pace and track your progress over time.',
          comingTitle: 'Coming Tests',
          startExam: 'Start Exam',
          exam1Title: 'English - Unit 5',
          exam1Meta: 'Sunday, 18:00 | 45 min',
          exam2Title: 'Math - Functions',
          exam2Meta: 'Tuesday, 16:30 | 60 min',
          exam3Title: 'Science - Respiratory System',
          exam3Meta: 'Thursday, 17:00 | 35 min',
          groupsTitle: 'My Groups',
          group1: 'Class 9-1 - English',
          group1Meta: 'Teacher: Ashraf Sharqawi',
          group2: 'Class 9-1 - Math',
          group2Meta: 'Teacher: Mohammad Abdulrahman',
          group3: 'Class 9-1 - Science',
          group3Meta: 'Teacher: Sumaya Hassan',
          viewGroup: '→ View Details',
          learningTitle: 'Process of Learning',
          learningPlaceholder: 'Line Chart Placeholder: Grade Trend over last 5 exams',
          reportsTitle: 'Recent Reports',
          reportsExam: 'Exam',
          reportsGrade: 'Final Grade',
          reportsAction: 'Action',
          viewFeedback: 'View Feedback',
          report1Exam: 'English - Unit 4',
          report2Exam: 'Math - Fractions',
          report3Exam: 'Science - Ecology',
          settingsTitle: 'Settings',
          settingsText: 'Manage language, accessibility, and exam notification preferences.'
        }
      };

      function applyLanguage(lang) {
        var t = I18N[lang] || I18N.ar;
        var titleEl = document.getElementById('welcome-title');
        var metaDesc = document.querySelector('meta[name="description"]');
        var nodes = document.querySelectorAll('[data-i18n]');

        document.title = t.pageTitle;
        if (metaDesc) metaDesc.setAttribute('content', t.pageDescription);

        for (var i = 0; i < nodes.length; i++) {
          var key = nodes[i].getAttribute('data-i18n');
          if (t[key]) nodes[i].textContent = t[key];
        }

        if (titleEl) titleEl.textContent = t.welcomeTemplate.replace('{name}', STUDENT_NAME);
      }

      document.addEventListener('mitests:languagechange', function (e) {
        var lang = (e.detail && e.detail.lang) || document.documentElement.getAttribute('lang') || 'ar';
        applyLanguage(lang);
      });

      document.addEventListener('DOMContentLoaded', function () {
        var lang = document.documentElement.getAttribute('lang') || 'ar';
        applyLanguage(lang);
      });
    })();
  </script>
  <script>
  (function(){
    var bell = document.querySelector('#student-notif-bell .notification-bell__btn');
    var panel = document.getElementById('student-notif-panel');
    var badge = document.getElementById('student-notif-badge');
    var body = document.getElementById('student-notif-body');
    var markBtn = document.getElementById('student-mark-read');
    var notifs = [
      {icon:'exam',text:'اختبار جديد: إنجليزي الوحدة 5 — بعد 4 أيام',time:'منذ 10 دقائق',unread:true},
      {icon:'grade',text:'تم نشر نتيجة اختبار الرياضيات - 92%',time:'منذ ساعتين',unread:true},
      {icon:'alert',text:'إعلان من المعلم أشرف شرقاوي: مراجعة يوم الأربعاء',time:'أمس',unread:false},
      {icon:'exam',text:'تم إضافة مواد دراسية جديدة لمجموعة الإنجليزي',time:'منذ 3 أيام',unread:false}
    ];
    function render(){
      var unread=0;body.innerHTML='';
      for(var i=0;i<notifs.length;i++){var n=notifs[i];if(n.unread)unread++;
        body.innerHTML+='<div class="notification-item'+(n.unread?' notification-item--unread':'')+'"><div class="notification-item__icon notification-item__icon--'+n.icon+'"><i class="fas fa-'+(n.icon==='exam'?'file-lines':n.icon==='grade'?'star':'bell')+'"></i></div><div class="notification-item__content"><p class="notification-item__text">'+n.text+'</p><span class="notification-item__time">'+n.time+'</span></div></div>';
      }
      badge.textContent=unread;badge.style.display=unread?'flex':'none';
    }
    bell.addEventListener('click',function(e){e.stopPropagation();panel.classList.toggle('notification-panel--open');});
    document.addEventListener('click',function(e){if(!panel.contains(e.target)&&e.target!==bell)panel.classList.remove('notification-panel--open');});
    markBtn.addEventListener('click',function(){for(var i=0;i<notifs.length;i++)notifs[i].unread=false;render();});
    render();
  })();
  </script>
  <button class="chat-fab chat-fab--student" id="chat-fab" type="button" aria-label="فتح الدردشة"><i class="fas fa-comments"></i><span class="chat-fab__badge">1</span></button>
  <div class="chat-widget" id="chat-widget">
    <div class="chat-widget__header chat-widget__header--student"><span>الدردشة مع المعلمين</span><button class="chat-widget__close" id="chat-close" type="button"><i class="fas fa-xmark"></i></button></div>
    <div class="chat-widget__body">
      <div class="chat-widget__threads" id="chat-threads"></div>
      <div class="chat-widget__messages-area">
        <div class="chat-widget__messages" id="chat-messages"></div>
        <div class="chat-widget__compose"><textarea id="chat-input" placeholder="اكتب رسالة..." rows="1"></textarea><button class="chat-widget__send" id="chat-send" type="button"><i class="fas fa-paper-plane"></i></button></div>
      </div>
    </div>
  </div>
  <script>
  (function(){
    var fab=document.getElementById('chat-fab'),widget=document.getElementById('chat-widget'),closeBtn=document.getElementById('chat-close'),threadsEl=document.getElementById('chat-threads'),msgsEl=document.getElementById('chat-messages'),inputEl=document.getElementById('chat-input'),sendBtn=document.getElementById('chat-send');
    var threads=[
      {id:'ashraf',title:'أشرف شرقاوي - إنجليزي',msgs:[{me:true,text:'أستاذ، هل يوجد واجب هذا الأسبوع؟',t:'14:20'},{me:false,text:'نعم، حل تمارين الوحدة 5 صفحة 42-44.',t:'14:35'}]},
      {id:'mohammad',title:'محمد عبد الرحمن - رياضيات',msgs:[{me:true,text:'أستاذ، السؤال 7 في الاختبار لم أفهمه.',t:'16:00'},{me:false,text:'سأشرحه في حصة المراجعة يوم الأربعاء.',t:'16:10'}]}
    ];
    var cur='ashraf';
    function find(){for(var i=0;i<threads.length;i++)if(threads[i].id===cur)return threads[i];return threads[0];}
    function renderThreads(){threadsEl.innerHTML='';for(var i=0;i<threads.length;i++){var t=threads[i];threadsEl.innerHTML+='<button class="chat-thread-btn'+(t.id===cur?' chat-thread-btn--active':'')+'" data-tid="'+t.id+'">'+t.title+'</button>';}}
    function renderMsgs(){var t=find();msgsEl.innerHTML='';for(var i=0;i<t.msgs.length;i++){var m=t.msgs[i];msgsEl.innerHTML+='<div class="chat-msg '+(m.me?'chat-msg--me':'chat-msg--them')+'">'+m.text+'<div class="chat-msg__time">'+m.t+'</div></div>';}msgsEl.scrollTop=msgsEl.scrollHeight;}
    fab.addEventListener('click',function(){widget.classList.toggle('chat-widget--open');});
    closeBtn.addEventListener('click',function(){widget.classList.remove('chat-widget--open');});
    threadsEl.addEventListener('click',function(e){var b=e.target.closest('[data-tid]');if(b){cur=b.dataset.tid;renderThreads();renderMsgs();}});
    sendBtn.addEventListener('click',function(){var txt=inputEl.value.trim();if(!txt)return;var t=find();var d=new Date();t.msgs.push({me:true,text:txt,t:String(d.getHours()).padStart(2,'0')+':'+String(d.getMinutes()).padStart(2,'0')});inputEl.value='';renderMsgs();});
    inputEl.addEventListener('keydown',function(e){if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();sendBtn.click();}});
    renderThreads();renderMsgs();
  })();
  </script>
</body>
</html>


