<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mitests - ملاحظات التقرير</title>
  <meta name="description" content="صفحة ملاحظات تفصيلية لتقرير الطالب بعد الاختبار.">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link rel="stylesheet" href="styles.css">

  <style>
    .student-navbar { border-bottom: 1px solid var(--color-gray-200); }
    body.rtl .main-content .student-navbar { right: var(--sidebar-width); left: 0; }
    body.ltr .main-content .student-navbar { left: var(--sidebar-width); right: 0; }
    body.rtl .main-content.main-content--expanded .student-navbar { right: var(--sidebar-collapsed-width); }
    body.ltr .main-content.main-content--expanded .student-navbar { left: var(--sidebar-collapsed-width); }
    .student-navbar .navbar__brand-icon { background: linear-gradient(135deg, var(--color-student), #24c6c6); }
    .sidebar__item:hover, .sidebar__item--active { background: rgba(14, 165, 165, 0.22); color: var(--color-white); }
    .sidebar__item--active { border-inline-start: 3px solid var(--color-student); }
    .btn--student { background: var(--color-student); border-color: var(--color-student); color: var(--color-white); }
    .btn--student:hover { background: #0b8b8b; border-color: #0b8b8b; color: var(--color-white); }

    .main {
      padding: calc(var(--navbar-height) + var(--space-6)) var(--space-6) var(--space-8);
      display: grid;
      gap: var(--space-4);
      max-width: 980px;
    }

    .back-link {
      display: inline-flex;
      align-items: center;
      gap: var(--space-2);
      color: var(--color-student);
      font-weight: 700;
      text-decoration: none;
      width: fit-content;
    }

    .header-card {
      background: linear-gradient(145deg, rgba(14,165,165,0.14), rgba(255,255,255,1) 58%);
      border: 1px solid var(--color-teal-100);
      border-top: 4px solid var(--color-student);
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow-md);
      padding: var(--space-5);
      display: flex;
      justify-content: space-between;
      gap: var(--space-4);
      flex-wrap: wrap;
      align-items: center;
    }

    .header-card h1 { color: var(--color-gray-900); font-size: var(--font-size-2xl); margin-bottom: var(--space-1); }
    .header-meta { color: var(--color-gray-600); font-size: var(--font-size-sm); display: flex; gap: var(--space-3); flex-wrap: wrap; }

    .score-pill {
      background: var(--color-teal-100);
      border: 1px solid rgba(14,165,165,0.25);
      color: #0b8b8b;
      border-radius: var(--border-radius-full);
      padding: var(--space-2) var(--space-4);
      font-size: var(--font-size-lg);
      font-weight: 700;
      display: inline-flex;
      align-items: center;
      gap: var(--space-2);
    }

    .card-block {
      background: var(--color-white);
      border: 1px solid var(--color-gray-200);
      border-top: 4px solid var(--color-student);
      border-radius: var(--border-radius-md);
      box-shadow: var(--shadow-sm);
      padding: var(--space-4);
      display: grid;
      gap: var(--space-3);
    }

    .card-block h2 { color: var(--color-gray-900); font-size: var(--font-size-xl); }

    .note-box {
      background: var(--color-gray-50);
      border: 1px solid var(--color-gray-200);
      border-radius: var(--border-radius-sm);
      padding: var(--space-4);
      color: var(--color-gray-700);
      line-height: 1.8;
      font-size: var(--font-size-sm);
    }

    .bullets {
      display: grid;
      gap: var(--space-2);
      color: var(--color-gray-700);
      font-size: var(--font-size-sm);
    }

    .bullets li { display: flex; align-items: flex-start; gap: var(--space-2); line-height: 1.7; }
    .bullets i { color: var(--color-student); margin-top: 4px; }

    .table-wrap { overflow-x: auto; }
    .data-table { width: 100%; border-collapse: collapse; min-width: 640px; }
    .data-table th, .data-table td {
      padding: var(--space-3);
      border-bottom: 1px solid var(--color-gray-200);
      text-align: start;
      font-size: var(--font-size-sm);
      vertical-align: top;
    }
    .data-table th { background: var(--color-gray-50); color: var(--color-gray-500); font-weight: 600; }

    @media (max-width: 1023px) {
      body.rtl .main-content .student-navbar { right: var(--sidebar-collapsed-width); }
      body.ltr .main-content .student-navbar { left: var(--sidebar-collapsed-width); }
      body.rtl .main-content { margin-right: var(--sidebar-collapsed-width); }
      body.ltr .main-content { margin-left: var(--sidebar-collapsed-width); }
      .sidebar { width: var(--sidebar-collapsed-width); }
      .sidebar .sidebar__brand-text, .sidebar .sidebar__item span, .sidebar .sidebar__toggle span { display: none; }
    }

    @media (max-width: 767px) {
      .sidebar { display: none; }
      body.rtl .main-content, body.ltr .main-content { margin: 0; }
      body.rtl .main-content .student-navbar, body.ltr .main-content .student-navbar { right: 0; left: 0; }
      .main { padding-inline: var(--space-4); }
    }
  </style>
</head>
<body class="rtl">
  <aside class="sidebar" id="sidebar" aria-label="Sidebar navigation">
    <div class="sidebar__header">
      <div class="sidebar__logo">M</div>
      <span class="sidebar__brand-text">سراج - الطالب</span>
    </div>
    <nav class="sidebar__nav">
      <a class="sidebar__item" href="student-dashboard.html"><i class="fas fa-gauge"></i><span>نظرة عامة</span></a>
      <a class="sidebar__item" href="student-coming-tests.html"><i class="fas fa-calendar-days"></i><span>اختبارات قادمة</span></a>
      <a class="sidebar__item" href="student-groups.html"><i class="fas fa-users"></i><span>مجموعاتي</span></a>
      <a class="sidebar__item" href="student-learning.html"><i class="fas fa-chart-line"></i><span>مسار التعلم</span></a>
      <a class="sidebar__item sidebar__item--active" href="student-reports.html"><i class="fas fa-file-circle-check"></i><span>تقارير حديثة</span></a>
      <a class="sidebar__item" href="student-settings.html"><i class="fas fa-gear"></i><span>الإعدادات</span></a>
    </nav>
    <button class="sidebar__toggle" id="sidebar-toggle" aria-label="Toggle sidebar"><i class="fas fa-angles-right"></i><span>تصغير</span></button>
  </aside>

  <div class="main-content" id="main-content">
    <nav class="navbar student-navbar" role="navigation" aria-label="Student top navigation">
      <a href="student-report-notes.html" class="navbar__brand">
        <div class="navbar__brand-icon"><i class="fas fa-message"></i></div>
        <span class="navbar__brand-text">ملاحظات التقرير</span>
      </a>
      <div class="navbar__actions">
        <div class="lang-switcher" role="group" aria-label="Language selector">
          <button class="lang-switcher__btn active" data-lang="ar" aria-label="Arabic">&#1593;</button>
          <button class="lang-switcher__btn" data-lang="he" aria-label="Hebrew">&#1506;&#1489;</button>
          <button class="lang-switcher__btn" data-lang="en" aria-label="English">En</button>
        </div>
        <a href="index.html" class="btn btn--student btn--sm"><i class="fas fa-right-from-bracket"></i><span>تسجيل الخروج</span></a>
      </div>
    </nav>

    <main class="main">
      <a class="back-link" href="student-reports.html"><i class="fas fa-arrow-right"></i><span>العودة إلى التقارير</span></a>

      <section class="header-card">
        <div>
          <h1 id="exam-title">الاختبار</h1>
          <div class="header-meta">
            <span><i class="fas fa-calendar-day"></i><span id="exam-date">-</span></span>
            <span><i class="fas fa-book"></i><span id="exam-subject">-</span></span>
          </div>
        </div>
        <div class="score-pill"><i class="fas fa-star"></i><span id="exam-score">-</span></div>
      </section>

      <section class="card-block">
        <h2>ملاحظة المعلم العامة</h2>
        <div class="note-box" id="teacher-note"></div>
      </section>

      <section class="card-block">
        <h2>نقاط القوة والتحسين</h2>
        <ul class="bullets" id="insights-list"></ul>
      </section>

      <section class="card-block">
        <h2>تفصيل الملاحظات حسب السؤال</h2>
        <div class="table-wrap">
          <table class="data-table">
            <thead>
              <tr>
                <th>السؤال</th>
                <th>النتيجة</th>
                <th>الملاحظة</th>
              </tr>
            </thead>
            <tbody id="questions-body"></tbody>
          </table>
        </div>
      </section>
    </main>
  </div>

  <script src="shared-layout.js"></script>
  <script>
    (function () {
      'use strict';

      var reports = {
        'eng-u4': {
          title: 'الإنجليزية - الوحدة 4',
          date: '2026-02-02',
          subject: 'اللغة الإنجليزية',
          score: '88/100',
          note: 'أداءك ممتاز في المفردات والتراكيب، وتحتاج فقط إلى مزيد من الدقة في ترتيب الأفكار عند الكتابة المطولة.',
          insights: [
            'نقطة قوة: استخدام مفردات متنوعة في الإجابات المقالية.',
            'نقطة تحسين: مراجعة القواعد الزمنية في جمل طويلة.',
            'توصية: تدريب قصير يومي على Writing Organization لمدة 15 دقيقة.'
          ],
          questions: [
            ['السؤال 1', '9/10', 'إجابة دقيقة مع مثال جيد.'],
            ['السؤال 2', '8/10', 'المعنى صحيح لكن الصياغة تحتاج ضبطًا نحويًا بسيطًا.'],
            ['السؤال 3', '7/10', 'الفكرة جيدة لكن التسلسل المنطقي غير مكتمل.']
          ]
        },
        'math-frac': {
          title: 'الرياضيات - الكسور',
          date: '2026-01-22',
          subject: 'الرياضيات',
          score: '92/100',
          note: 'نتيجة قوية جدًا، مع فهم واضح للكسور والعمليات الأساسية. استمر بنفس المستوى مع مسائل التطبيق المركبة.',
          insights: [
            'نقطة قوة: سرعة ودقة في التحويل بين الكسور والأعداد العشرية.',
            'نقطة تحسين: الانتباه لخطوات الاختصار في المسائل الطويلة.',
            'توصية: حل 5 مسائل لفظية إضافية أسبوعيًا.'
          ],
          questions: [
            ['السؤال 1', '10/10', 'حل صحيح وخطوات منظمة.'],
            ['السؤال 2', '9/10', 'الناتج صحيح مع خطأ كتابي بسيط في المنتصف.'],
            ['السؤال 3', '9/10', 'فهم جيد لمسألة لفظية متعددة الخطوات.']
          ]
        },
        'sci-eco': {
          title: 'العلوم - علم البيئة',
          date: '2026-01-10',
          subject: 'العلوم',
          score: '84/100',
          note: 'فهمك للمفاهيم الأساسية جيد، لكن تحتاج لربط أفضل بين السبب والنتيجة في الأسئلة التحليلية.',
          insights: [
            'نقطة قوة: تمييز المفاهيم البيئية الأساسية بشكل صحيح.',
            'نقطة تحسين: توضيح العلاقة بين العوامل البيئية وتأثيراتها.',
            'توصية: مراجعة مخطط السلسلة الغذائية والتوازن البيئي.'
          ],
          questions: [
            ['السؤال 1', '8/10', 'إجابة صحيحة مع نقص مثال تطبيقي.'],
            ['السؤال 2', '7/10', 'الفكرة عامة صحيحة وتحتاج تفصيلًا أكثر.'],
            ['السؤال 3', '9/10', 'تحليل ممتاز في الجزء الأخير من السؤال.']
          ]
        }
      };

      function getParam(name) {
        var query = new URLSearchParams(window.location.search);
        return query.get(name);
      }

      function renderReport(data) {
        document.getElementById('exam-title').textContent = data.title;
        document.getElementById('exam-date').textContent = data.date;
        document.getElementById('exam-subject').textContent = data.subject;
        document.getElementById('exam-score').textContent = data.score;
        document.getElementById('teacher-note').textContent = data.note;

        var insightsList = document.getElementById('insights-list');
        insightsList.innerHTML = '';
        for (var i = 0; i < data.insights.length; i++) {
          var li = document.createElement('li');
          li.innerHTML = '<i class="fas fa-circle-check"></i><span>' + data.insights[i] + '</span>';
          insightsList.appendChild(li);
        }

        var tbody = document.getElementById('questions-body');
        tbody.innerHTML = '';
        for (var j = 0; j < data.questions.length; j++) {
          var q = data.questions[j];
          var tr = document.createElement('tr');
          tr.innerHTML = '<td>' + q[0] + '</td><td>' + q[1] + '</td><td>' + q[2] + '</td>';
          tbody.appendChild(tr);
        }
      }

      var examKey = getParam('exam') || 'eng-u4';
      var selected = reports[examKey] || reports['eng-u4'];
      renderReport(selected);
    })();
  </script>
</body>
</html>
