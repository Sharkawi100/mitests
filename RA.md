# Mitests.com - Requirement Analysis (RA) v2.2

## 1) مقدمة ورؤية المنتج
Mitests هي منصة تقييم تعليمي مدعومة بالذكاء الاصطناعي تهدف إلى تحويل الاختبار من عبء إلى أداة تعلم وتطوير حقيقي.

**الشعار:** وراء كل اختبار، إنسان.

## 2) النطاق (Scope)
النطاق الحالي يغطي تجربة Demo متكاملة عبر أدوار:
1. Admin (إدارة المنصة)
2. School (إدارة المؤسسة التعليمية)
3. Teacher (المعلم)
4. Student (الطالب)

مع واجهات متعددة اللغات (ar/he/en) ودعم RTL/LTR.

## 3) مبادئ تنظيم المسؤوليات
### 3.1 مستوى الإدارة العامة (Admin-Level)
يشمل فقط ما هو مركزي على مستوى المنصة:
- إعدادات مزودي الذكاء الاصطناعي وسياسات Fallback.
- مكتبة البرومبت المركزية.
- إدارة الخطط والاشتراكات.
- إدارة سجل المدارس.
- كتالوج مركزي للمراحل والمواد.
- تقارير ومؤشرات عامة على مستوى المنصة.

### 3.2 مستوى المدرسة (School-Level)
يشمل ما يخص كل مدرسة على حدة:
- الملف المؤسسي التفصيلي.
- إدارة المستخدمين داخل المدرسة.
- إدارة التوكنز وتوزيعها.
- White Label (الهوية المؤسسية الخاصة بالمدرسة).
- تدقيق/مراجعة الاختبارات داخل المدرسة.
- التواصل والإشعارات داخل المدرسة.

### 3.3 قرارات حوكمة مهمة
- **White Label** يكون للمدرسة، وليس لإدارة المنصة المركزية.
- **QA Feed التفصيلي** يكون داخل المدرسة (لتوسعية 300+ مدرسة).
- الإدارة المركزية تركز على القياس الكلي والسياسات، لا التشغيل اليومي لكل مدرسة.

## 4) خريطة الصفحات الحالية (Information Architecture)
> جميع الروابط يجب أن تكون صفحات مستقلة `*.html` بدون روابط داخلية من نوع `#section`.

### 4.1 صفحات عامة
- `index.html`: الصفحة الرئيسية + اختيار الدور.

### 4.2 Admin
- `admin-dashboard.html`: نظرة عامة مركزية.
- `admin-ai-config.html`: إعدادات AI.
- `admin-prompt-library.html`: مكتبة البرومبت.
- `admin-plans.html`: الخطط والاشتراكات.
- `admin-schools.html`: قائمة المدارس + إضافة مدرسة.
- `admin-settings.html`: مركز الإعدادات الإدارية.
- `admin-grades-catalog.html`: كتالوج المراحل (قائمة + إضافة/تعديل/حذف).
- `admin-subjects-catalog.html`: كتالوج المواد (قائمة + إضافة/تعديل/حذف).
- `admin-profile.html`: ملف المدير.
- `admin-school-profile.html`, `admin-teacher-profile.html`, `admin-student-profile.html`: ملفات مرجعية.

### 4.3 School
- `school.html`: لوحة المدرسة.
- `school-profile.html`: الملف المؤسسي.
- `school-tokens.html`: إدارة التوكنز.
- `school-users.html`: التوجيه الرئيسي للمستخدمين.
- `school-users-teachers.html`: إدارة المعلمين (إضافة/تعديل/صلاحيات).
- `school-users-students.html`: إدارة الطلاب (إضافة/تعديل/تقارير).
- `school-users-staff.html`: إدارة الموظفين (أدوار/صلاحيات).
- `school-qa-review.html`: مراجعة الاختبارات.
- `school-approval.html`: اعتماد المحتوى.
- `school-communications.html`: التواصل والإشعارات.
- `school-settings.html`: إعدادات المدرسة.
- `school-whitelabel.html`: الهوية المؤسسية.

### 4.4 Teacher
- `teacher-dashboard.html`: لوحة المعلم.
- `teacher-exams.html`: اختباراتي.
- `exam-wizard.html`: معالج إنشاء الاختبار.
- `exam-assessment.html`: اعتماد/تعديل تقييم AI.
- `exam-report.html`: تقرير المجموعة.
- `teacher-group.html`: المجموعات.
- `teacher-question-bank.html`: بنك الأسئلة.
- `teacher-community.html`: المجتمع.
- `teacher-settings.html`: إعدادات المعلم.
- `teacher-profile.html`: ملف المعلم.

### 4.5 Student
- `student-dashboard.html`: لوحة الطالب.
- `student-coming-tests.html`: الاختبارات القادمة.
- `student-groups.html`: مجموعاتي.
- `student-group-detail.html`: تفاصيل مجموعة.
- `student-learning.html`: مسار التعلم.
- `student-reports.html`: التقارير.
- `student-feedback.html`: ملاحظات/تغذية راجعة.
- `student-exam.html`: واجهة الاختبار.
- `student-settings.html`: الإعدادات.
- `student-profile.html`: الملف الشخصي.

## 5) المتطلبات الوظيفية الأساسية

### 5.1 إدارة المدارس (Admin Schools)
#### 5.1.1 إنشاء مدرسة جديدة
حقول الإضافة الأساسية:
- أيقونة/شعار المؤسسة (اختياري).
- رمز المؤسسة التعليمية.
- اسم المؤسسة.
- البريد الإلكتروني للمؤسسة (إلزامي).
- المراحل التعليمية الخاصة بالمؤسسة (تُسحب من الكتالوج المركزي).

#### 5.1.2 ملف المدرسة المؤسسي
حقول ملف المؤسسة:
- الدولة.
- العنوان.
- الهاتف.
- روابط التواصل الاجتماعي.
- اللغة الافتراضية.
- بيانات إضافية خاصة بالهوية المؤسسية.

### 5.2 إدارة المستخدمين في المدرسة (School Users)
#### 5.2.1 المعلمون (Teachers)
- قائمة بحث وتصفية.
- إضافة معلم: الاسم، البريد، التخصص، **الصفوف الدراسية (7-12)**.
- تعديل بيانات المعلم.
- إدارة الصلاحيات (أيقونة المفتاح).

#### 5.2.2 الطلاب (Students)
- إضافة طالب: الاسم، الصف، الشعبة، رقم ولي الأمر.
- تعديل بيانات الطالب.
- تقرير الطالب (أيقونة الملف).

#### 5.2.3 الموظفون (Staff)
- أدوار محددة: Admin, Secretary, Supervisor, Accountant.
- صلاحيات دقيقة (Checkbox Matrix).

### 5.3 إدارة التوكنز (Tokens)
- رصيد ديناميكي للمدرسة.
- سجل حركات (Transaction History) لعمليات التوزيع.
- إضافة رصيد للمعلمين.

### 5.4 كتالوج المراحل والمواد (Admin Catalog)
- إدارة على شكل **قوائم فعلية** وليس textarea بفواصل.
- إضافة عنصر واحد بزر إضافة.
- بحث داخل القائمة.
- تعديل وحذف العنصر.
- استرجاع القيم الافتراضية.
- حفظ مركزي ليتم استهلاكه في صفحات المدارس والمعلمين.

### 5.5 معالج إنشاء الاختبار (Exam Wizard)
نسخة المعالج الحالية تعتمد 4 خطوات:
1. General Info
2. Content Source
3. AI Structure
4. Review & Generate

متطلبات ضمن الخطوات:
- مصادر المحتوى: رفع ملف / توليد نص AI / لصق يدوي.
- عند توليد نص AI: حقل "النمط" يكون Dropdown: `قصة`، `حوار`، `قطعة علمية`، `مقال`.
- اختيار أنواع الأسئلة (MC, Open-end, True/False ...).
- Smart Weighting حسب Bloom.
- عند الضغط على Generate: إظهار Processing Overlay ثم الانتقال لمرحلة التقييم.

### 5.6 التقييم واعتماد العلامات
- `exam-assessment.html` يعرض:
  - مقارنة AI Suggested Grade مقابل Teacher Confirmed Grade.
  - مراجعة إجابة كل سؤال مع تفسير AI.
  - تعديل يدوي/اعتماد.
  - ملاحظة المعلم.
- زر Finalize ينقل إلى `exam-report.html`.

### 5.7 تجربة الطالب داخل الاختبار
- واجهة Focus Mode بدون Sidebar.
- مؤقت ثابت مع تنبيه أحمر في آخر 5 دقائق.
- Lockdown تحذيري عبر `visibilitychange` عند مغادرة التبويب.
- مؤشر Autosave دوري.
- دعم LaTeX في الأسئلة.

## 6) التدفقات الأساسية (End-to-End Flows)
### 6.1 تدفق الإدارة
1. الدخول كمدير.
2. ضبط Catalog (Grades/Subjects).
3. إضافة/تعديل المدارس.
4. ضبط خطط الاشتراك وإعدادات AI.

### 6.2 تدفق المدرسة
1. تحديث الملف المؤسسي.
2. إدارة المستخدمين والتوكنز.
3. تدقيق واعتماد المحتوى والاختبارات داخل المدرسة.

### 6.3 تدفق المعلم
1. إنشاء اختبار من `exam-wizard.html`.
2. مراجعة التقييم في `exam-assessment.html`.
3. إصدار تقرير المجموعة في `exam-report.html`.

### 6.4 تدفق الطالب
1. متابعة الاختبارات القادمة.
2. أداء الاختبار في `student-exam.html`.
3. مراجعة التغذية الراجعة في `student-feedback.html`.

## 7) متطلبات تجربة المستخدم (UX)
- العربية هي الوضع الافتراضي.
- دعم كامل للغات: العربية، العبرية، الإنجليزية.
- RTL/LTR يجب أن يعمل عبر كل الواجهات.
- توحيد تصميم المكونات (Sidebar/Navbar/Cards/Tables/Modals).
- منع الروابط الداخلية `#...` في التنقل الأساسي واعتماد صفحات مستقلة.

## 8) متطلبات تقنية غير وظيفية (NFR)
- بنية Frontend ثابتة ومرنة للتوسع.
- قابلية التوسع لعدد كبير من المدارس (300+).
- فصل واضح بين صلاحيات Admin وSchool.
- جاهزية التكامل لاحقًا مع Backend (Node.js + Soft-code).
- جاهزية تكامل Realtime للأحداث الحرجة (الاختبار/التنبيهات).

## 9) الفجوات/التحسينات المقترحة (Backlog Next)
- تحويل بعض عمليات التعديل إلى Popups موحدة بدل `prompt`.
- توحيد مركز الإشعارات/الدردشة وتحديد المالك الوظيفي (School vs Teacher).
- تعريف أوضح لميزة "استخدام في اختبار" داخل بنك الأسئلة (إضافة مباشرة إلى معالج الاختبار مع حفظ السياق).
- تحسين صلاحيات القوائم المنسدلة من الأفاتار لكل دور بحيث تكون شخصية فقط.

## 10) معايير القبول (Acceptance Checklist)
- [ ] كل قسم وظيفي موجود في المستوى الصحيح (Admin vs School).
- [ ] الكتالوج المركزي يعمل بقوائم إضافة/تعديل/حذف وليس نص حر بالفواصل.
- [ ] تدفق إنشاء الاختبار -> التقييم -> التقرير يعمل عبر صفحات مستقلة.
- [ ] لا توجد روابط `#` في التنقل الرئيسي.
- [ ] جميع صفحات الأدوار تدعم العربية افتراضيًا مع he/en.
- [ ] جميع أزرار الخروج تعود إلى `index.html`.
- [ ] تقسيم إدارة المستخدمين إلى 3 صفحات (Teachers, Students, Staff) مع Modals وظيفية لكل دور.
- [ ] سجل حركات التوكنز يعمل ويحدث الرصيد.

---

**Document Status:** Updated (v2.2) - aligned with current demo pages and latest product decisions.
